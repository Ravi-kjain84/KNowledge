import pandas as pd
from pyxlsb import open_workbook

# Define the path to your XLSB file
path_to_file = 'path_to_your_file.xlsb'

# This will hold your data with sheet names as keys
data_frames = {}

# Open the XLSB file
with open_workbook(path_to_file) as wb:
    # Iterate through each sheet in the workbook
    for sheet_name in wb.sheets:
        # Using the sheet name to open the sheet
        with wb.get_sheet(sheet_name) as sheet:
            # Convert rows to a DataFrame
            df = pd.DataFrame(sheet.rows())
            
            # If the first row contains headers, set it as DataFrame header
            if not df.empty:
                df.columns = df.iloc[0]  # Set the first row as the column names
                df = df[1:]              # Remove the first row from the data

            # Store the DataFrame in a dictionary using the sheet name as the key
            data_frames[sheet_name] = df

# Now, you can access each sheet's DataFrame from the dictionary by its sheet name
# Example to print all data frames:
for name, frame in data_frames.items():
    print(f"Data from sheet: {name}")
    print(frame)