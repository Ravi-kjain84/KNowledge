from pptx import Presentation
from pptx.chart.data import CategoryChartData
from pptx.enum.chart import XL_CHART_TYPE
from pptx.util import Inches

# Sample data for the bar chart
categories = ['Apples', 'Oranges', 'Pears', 'Bananas']
values = [50, 30, 40, 60]

# Load the PowerPoint file (make sure it has at least one slide with a chart)
ppt_file = 'template.pptx'  # Update this to your PowerPoint template path
prs = Presentation(ppt_file)

# Assuming the template has at least one slide with a chart
slide = prs.slides[0]  # Get the first slide with the chart
chart = slide.shapes[0].chart  # Get the first chart on the slide

# Update the chart data
data = CategoryChartData()
data.categories = categories
data.add_series('Fruit Sales', values)

# Assign new data to the chart
chart.replace_data(data)

# Save the updated presentation
prs.save('updated_presentation.pptx')

********************

import pandas as pd
from pptx import Presentation
from pptx.chart.data import CategoryChartData
from pptx.enum.shapes import MSO_SHAPE_TYPE

# Sample data simulating an Excel read
data = {
    'Title': ['Sales Report 2022'],
    'Categories': ['Q1', 'Q2', 'Q3', 'Q4'],
    'Sales': [150, 200, 175, 225]
}
df = pd.DataFrame(data)

# Load the presentation and select the first slide
ppt_file = 'template.pptx'  # Update this to your PowerPoint template path
prs = Presentation(ppt_file)
slide = prs.slides[0]

# Handling placeholders, ensuring correct identification
for placeholder in slide.placeholders:
    if placeholder.shape_type == MSO_SHAPE_TYPE.PICTURE_FRAME:
        text_placeholder = placeholder
    elif placeholder.shape_type == MSO_SHAPE_TYPE.CHART:
        chart_placeholder = placeholder

# Update the text placeholder
if 'text_placeholder' in locals():
    text_placeholder.text = df['Title'].iloc[0]

# Handle the chart data update
if 'chart_placeholder' in locals():
    chart = chart_placeholder.chart
    chart_data = CategoryChartData()
    chart_data.categories = df['Categories'].tolist()
    chart_data.add_series('Sales', df['Sales'].tolist())
    chart.replace_data(chart_data)
else:
    print("No chart placeholder found")

# Save the updated presentation
prs.save('updated_presentation.pptx')

****************

from pptx import Presentation
from pptx.chart.data import CategoryChartData
from pptx.enum.chart import XL_CHART_TYPE
from pptx.util import Inches

# Load the presentation
prs = Presentation('template.pptx')  # Ensure you have a template file
slide = prs.slides[0]  # Access the first slide

# Assuming the placeholder is intended for a chart
placeholder = slide.placeholders[0]  # Get the first placeholder

# Check if the placeholder contains a graphic frame with a chart
if placeholder.shape_type == MSO_SHAPE_TYPE.GRAPHIC_FRAME and hasattr(placeholder, 'chart'):
    chart = placeholder.chart  # Access the chart

    # Create new chart data
    chart_data = CategoryChartData()
    chart_data.categories = ['Q1', 'Q2', 'Q3', 'Q4']
    chart_data.add_series('Example Series', (24, 40, 70, 50))

    # Update the chart data
    chart.replace_data(chart_data)
else:
    print("The selected placeholder does not contain a chart or is not a chart placeholder.")

# Save the presentation
prs.save('updated_presentation.pptx')


**********************

import pandas as pd

# Sample data
data = {
    'Category': ['A', 'B', 'C', 'D', 'E'],
    'Value1': [10, 20, 15, 30, 25],
    'Value2': [5, 12, 8, 18, 14]
}

# Create the DataFrame
my_chart_data = pd.DataFrame(data)

# Display the DataFrame
print(my_chart_data)

from pptx import Presentation

# Load the presentation
prs = Presentation('having-chart-placeholder.pptx')

# Get the second slide layout (assuming the chart placeholder is on this layout)
slide_layout = prs.slide_layouts[1]

# Get the chart placeholder shape
chart_placeholder = slide_layout.placeholders[10]

# Insert a chart into the placeholder (you'll need to create your chart data first)
chart = chart_placeholder.insert_chart(chart_type='bar', data=my_chart_data)

# Save the modified presentation
prs.save('modified-presentation.pptx')

***********

from pptx import Presentation
from pptx.enum.chart import XL_CHART_TYPE
from pptx.util import Inches

# Create a Presentation object
prs = Presentation()

# Add a slide with a blank layout (usually layout 6 is blank)
slide_layout = prs.slide_layouts[6]  # Adjust the index based on your template
slide = prs.slides.add_slide(slide_layout)

# Define the position and size of the chart
x, y, cx, cy = Inches(2), Inches(2), Inches(4.5), Inches(3)

# Add a chart to the slide
chart = slide.shapes.add_chart(
    XL_CHART_TYPE.COLUMN_CLUSTERED, x, y, cx, cy
).chart

# Now, you can modify the chart data
chart_data = chart.chart_data  # Get chart data
chart_data.categories = ['Q1', 'Q2', 'Q3', 'Q4']
chart_data.add_series('Series 1', (20, 40, 60, 80))

# Save the presentation
prs.save('presentation_with_chart.pptx')
